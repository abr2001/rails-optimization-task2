1. Заменил to_json на Oj.dump(report).
  Теперь укладываюсь в 29 сек !!! Есть !!!

2. Замерил память
  MEMORY USAGE: 1688 MB
  Нормально так :)

3. Переделываю чтение файла построчно
    сделал общую статистику

4. Переделал полностью построчно
  33.450760559 sec
  MEMORY USAGE: 838 MB

  В 2 раза меньше потребление памяти, но до бюджета далеко

  возможно нужно писать в файл тоже тоже построчно

  Пройдусь профилировщиками, как положено :)

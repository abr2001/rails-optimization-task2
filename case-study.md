1. Заменил to_json на Oj.dump(report).
  Теперь укладываюсь в 29 сек !!! Есть !!!

2. Замерил память
  MEMORY USAGE: 1688 MB
  Нормально так :)

3. Переделываю чтение файла построчно
    сделал общую статистику
    MEMORY USAGE: 22 MB
